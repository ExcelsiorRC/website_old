{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/my-second-post/","result":{"data":{"site":{"siteMetadata":{"title":"Excelsior RC"}},"markdownRemark":{"id":"d6c69e7c-b6a3-5c46-9d67-4ee147254eed","excerpt":"Wow! I love blogging so much already. Did you know that “despite its name, salted duck eggs can also be made from\nchicken eggs, though the taste and texture…","html":"<p>Wow! I love blogging so much already.</p>\n<p>Did you know that “despite its name, salted duck eggs can also be made from\nchicken eggs, though the taste and texture will be somewhat different, and the\negg yolk will be less rich.”?\n(<a href=\"https://en.wikipedia.org/wiki/Salted_duck_egg\">Wikipedia Link</a>)</p>\n<p>Yeah, I didn’t either.</p>","frontmatter":{"title":"My Second Post!","date":"May 06, 2015","description":null,"category":"React"},"fields":{"slug":"/my-second-post/"}},"previous":null,"next":{"fields":{"slug":"/new-beginnings/"},"frontmatter":{"title":"Infinite Scroll Util"}},"allMarkdownRemark":{"group":[{"fieldValue":"React"},{"fieldValue":"TypeScript"}],"nodes":[{"excerpt":"…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3d21e74b690f1ed03d156b90028866b0/f0293/infinite-scroll-shift.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.06329113924051%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8UlEQVQoz3WTXXPSQBSG+1v1H/hbvPDKwRtHpXXGC50ppdBCEZSPtE6ABkggTaFUQgLNNyE8krQiMDWT7G7es+eZ3T3vHrD3rFarpHccF2UwpH9zR68/ZKIbiR5FEdrwHkUdIQ9GqNody+Vyk3uwD4yiR6DU/82HE4UvRY30mcZZXYtT8IOQz7kuR2stjh3mB8we7H/AuNn+/gI7qsmFaCHIPuJNRL0zW6tLPD8kL0yodX1aWki57WDOnf+v8GnHSKpBTjD5ce1Q6wX8bBsbYLY2prIGXSkeRXG+C4wb13XxPC/pgyB4WqFBuWWukxxatwFC5xHoL0JOqmOKTYeG7FEQH5htA8MwRBRFBEGgVCqh69Mk2OhOefHa5FXK4eUbj9TpNAHO5ws+5sdkqjbnlw6fCiYTc+sMF4sFlUqFptjEcKfYNZ+H9zbSrUEqPePw2OZt2iZb1XGPLbR3JvnKPcIa2KhZZDJTDHOvKKZp4rleIrodH6+0QBsNKXw757reopz5zq8rkaAXMr+0yZ9eUM41qBavyH4tYln280WJltFmbFkWbUmir6p0ZZnRaLSJaZqG3FeQFZmBOtj14bZlEjG2zfr1fZ+O1EG6lpBlJYGslo9z4h212+3kmHRd33HJwf4N2R8/d5P24/F/7I64Hn8A+yM5dDX8KfYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"infinite-scroll-shift\"\n        title=\"infinite-scroll-shift\"\n        src=\"/static/3d21e74b690f1ed03d156b90028866b0/f058b/infinite-scroll-shift.png\"\n        srcset=\"/static/3d21e74b690f1ed03d156b90028866b0/c26ae/infinite-scroll-shift.png 158w,\n/static/3d21e74b690f1ed03d156b90028866b0/6bdcf/infinite-scroll-shift.png 315w,\n/static/3d21e74b690f1ed03d156b90028866b0/f058b/infinite-scroll-shift.png 630w,\n/static/3d21e74b690f1ed03d156b90028866b0/40601/infinite-scroll-shift.png 945w,\n/static/3d21e74b690f1ed03d156b90028866b0/78612/infinite-scroll-shift.png 1260w,\n/static/3d21e74b690f1ed03d156b90028866b0/f0293/infinite-scroll-shift.png 2250w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>소개</h2>\n<p>무한 스크롤은 사용자가 페이지를 아래로 스크롤 할 때 콘텐츠를 지속적으로 로드 하는 기술이다. <code class=\"language-text\">Pagenation</code>과 비슷하지만 모바일에 특화된 기술이라고 볼 수 있다.\n스크롤을 내리며 화면의 끝에 닿으면 비동기 적으로 콘텐츠를 로드하고, 이는 사용자 경험을 향상시켜준다.</p>\n<p>무한 스크롤을 구현하는 방법에는 여러가지 방법이 있다. 전통적인? 방법은 <code class=\"language-text\">scroll</code> 윈도우 객체 또는 특정 <code class=\"language-text\">div</code>에 eventListenr를 추가하고, <code class=\"language-text\">div</code>가 화면 끝에 닿았을 때 data를 새로 로드하는 방식이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">InfiniteScroll</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchData</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// api logic</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleScroll</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> documentElement <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> document\n    <span class=\"token keyword\">const</span> scrollHeight <span class=\"token operator\">=</span> documentElement<span class=\"token punctuation\">.</span>scrollHeight<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> scrollTop <span class=\"token operator\">=</span> documentElement<span class=\"token punctuation\">.</span>scrollTop<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> clientHeight <span class=\"token operator\">=</span> documentElement<span class=\"token punctuation\">.</span>clientHeight<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>scrollTop <span class=\"token operator\">+</span> clientHeight <span class=\"token operator\">>=</span> scrollHeight<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        fetchData\n     <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"scroll\"</span><span class=\"token punctuation\">,</span> handleScroll<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"scroll\"</span><span class=\"token punctuation\">,</span> handleScroll<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>코드로 작성하면 이런 느낌이 될 것 같다.\n분명 이 방법도 나쁘진 않다. 코드가 복잡하지 않고, 간단하게 infinite Scroll의 구현이 가능하다. <br/>\n다만, <code class=\"language-text\">scroll</code> 이벤트 이벤트가 수백번 호출되고, UI스레드(메인스레드)에 영향을 준다. 감지하는 이벤트가 끊임없이 호출되기 때문에 성능에 영향을 주는 것이다.\n이런 단점을 상쇄하려면 <code class=\"language-text\">Debounce</code>(함수를 그룹핑), <code class=\"language-text\">throttling</code> (200ms에 한번 감지한다던지)로 문제를 해결할 수 있다. 뭔가 일을 더 키우는 것 같아서 더 좋은 방법이 없을까 찾아보았다.</p>\n<h2>Intersection Observer</h2>\n<p>대안으로 사용할 <code class=\"language-text\">Intersection Observer</code> 이다. 여타 다른 블로그에서 소개 하고 있고, 나 또한 공감해서 이를 발전 시켜 <code class=\"language-text\">Infinite Scroll Util</code>을 생성해보았다.</p>\n<p><a href=\"https://developer.mozilla.org/ko/docs/Web/API/IntersectionObserver/IntersectionObserver\">Intersection Observer</a></p>\n<blockquote>\n <p> 대상(target) 으로 칭하는 요소가 기기 뷰포트나 특정 요소와 교차하는 것을 감지한다.</p>\n </blockquote>\n<p>이 특성을 이용해서 페이지의 끝에 겹쳐지는 부분을 감지할 element를 생성하고 element가 화면에 노출되면 새로운 데이터를 불러온다.</p>\n<p>먼저, <code class=\"language-text\">useTargetObserver</code>이라는 Custom Hook을 생성한다. target을 <code class=\"language-text\">IntersctionObserver</code>로 감지해서 root(viewport)와 겹치면 <code class=\"language-text\">isInterseting</code> 이 true로 변경된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useEffect<span class=\"token punctuation\">,</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> defaultOptions<span class=\"token operator\">:</span> IntersectionObserverInit <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  threshold<span class=\"token operator\">:</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token generic-function\"><span class=\"token function\">useTargetObserver</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> Element<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>\n  customOptions<span class=\"token operator\">?</span><span class=\"token operator\">:</span> IntersectionObserverInit<span class=\"token punctuation\">,</span>\n  target<span class=\"token operator\">?</span><span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span>RefObject<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> option <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>defaultOptions<span class=\"token punctuation\">,</span>\n    customOptions<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isIntersecting<span class=\"token punctuation\">,</span> setIntersecting<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> observer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IntersectionObserver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>entries<span class=\"token operator\">:</span> IntersectionObserverEntry<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setIntersecting</span><span class=\"token punctuation\">(</span>entries<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>isIntersecting<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> option<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>target<span class=\"token operator\">?.</span>current<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      observer<span class=\"token punctuation\">.</span><span class=\"token function\">observe</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      observer<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>observer<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> isIntersecting<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3056f66bf368ed4a365788e4ecb66192/dd507/IntersctionObserver.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.48101265822784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACHklEQVQ4y5VUTU/UQBhuPBjjRUPEaDT4ESOJP8A/oXhSMJHf4s14wUTxqomaqCgQA4t8ePIgRne5bVQUDpV27XY/WHbbJWw77zy+02mhsO6Ckzx5Zqadp88z70wNcJNSIt0khZAiYA40J0jG6jmvSdal1xvJgIjQarUi/p+218y2oBAC+Xwe2WwOTv4tnOwDOEuP4OQUHmpeGuX5ETjfp/HHcbG52ezsUIgwemnLK8Kf7IX/1ID/nPEsBTV+YqCZ6YfXqMM0f3cW9L0G3PI6Z98AFi4B7w4BU0cZR4D5Ps1qPGkAH6+ySgDbLnQWbPqeFgxrEJle0CsD9IYxtodfMhb6QaIFy7a7OPR9uK6rC/TjHuTiAOSXQcatFAZBi9chVx9Dlc6y1vYRLJW5F4I+XQNlToBm+xhnQTOnNc+eA033QGaHQVIJWt0Ek8hVFjil443HmDqueYLx2oD8cAUUbnHkQnfBkhIMYsGxtOCxnf7BBX2UosgURz4JmjuvY78/o+POXYi2ArnhaI21pvZQ7ro1Rvr6mKaJRsOHXL4P+fkG5NfbXIihGDdBink+/DWK9Y0m7Lgo6Vtj7FiWCARQLiwjmDgM+SI+KvOX2dlFXSQ+SuB5b7wHqys/UavVUK1WUKlUooRtDre/9O0uH48B7YwrqnGHHQ9FxwYrI/Fl8FAsFiPU63UtmBbTe6G87vND+MdPYVfkdlE6AGQbVPsLqRB4RlzEip0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"IntersctionObserver\"\n        title=\"IntersctionObserver\"\n        src=\"/static/3056f66bf368ed4a365788e4ecb66192/f058b/IntersctionObserver.png\"\n        srcset=\"/static/3056f66bf368ed4a365788e4ecb66192/c26ae/IntersctionObserver.png 158w,\n/static/3056f66bf368ed4a365788e4ecb66192/6bdcf/IntersctionObserver.png 315w,\n/static/3056f66bf368ed4a365788e4ecb66192/f058b/IntersctionObserver.png 630w,\n/static/3056f66bf368ed4a365788e4ecb66192/40601/IntersctionObserver.png 945w,\n/static/3056f66bf368ed4a365788e4ecb66192/78612/IntersctionObserver.png 1260w,\n/static/3056f66bf368ed4a365788e4ecb66192/dd507/IntersctionObserver.png 1528w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>이렇게 감지된다고 보면 된다.</p>\n<p>이 것을 활용한 Infinite Scroll Component를 생성해보자</p>\n<h3>Common component</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">InfiniteScrollProps</span> <span class=\"token punctuation\">{</span>\n  children<span class=\"token operator\">:</span> ReactNode<span class=\"token punctuation\">;</span>\n  <span class=\"token function-variable function\">trigger</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n  pageNumber<span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n  totalPageCount<span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n  isLoaded<span class=\"token operator\">:</span> boolean<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">InfiniteScroll</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token operator\">:</span> InfiniteScrollProps</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> pageNumber<span class=\"token punctuation\">,</span> totalPageCount<span class=\"token punctuation\">,</span> trigger<span class=\"token punctuation\">,</span> isLoaded <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> useRef <span class=\"token operator\">&lt;</span> HTMLDivElement <span class=\"token operator\">></span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> isIntersecting <span class=\"token operator\">=</span> useTargetObserver <span class=\"token operator\">&lt;</span> HTMLDivElement <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> threshold<span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> needMoreList <span class=\"token operator\">=</span> totalPageCount <span class=\"token operator\">></span> pageNumber<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isIntersecting <span class=\"token operator\">&amp;&amp;</span> needMoreList<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">trigger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>isIntersecting<span class=\"token punctuation\">,</span> needMoreList<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">{</span>isLoaded <span class=\"token operator\">&amp;&amp;</span> needMoreList <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">&lt;</span>div ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>target<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">}</span> <span class=\"token comment\">// loading or bottom element</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>사용부</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">SampleList</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> dispatch <span class=\"token operator\">=</span> <span class=\"token function\">useDispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> pageNumber<span class=\"token punctuation\">,</span> totalPageCount <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSelector</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> list <span class=\"token operator\">=</span> <span class=\"token function\">useSelector</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>InfiniteScroll\n      isLoaded<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>list<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span>\n      pageNumber<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>pageNumber<span class=\"token punctuation\">}</span>\n      totalPageCount<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>totalPageCount<span class=\"token punctuation\">}</span>\n      trigger<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span>list<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>InfiniteScroll<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>활용을 높이기 위해 Component를 생성하고 Component에 list등 원하는 data를 children으로 넘겨주면 작동하게 제작해보았다.\nInfinite Scroll에 사용되는 pageNumber, totalPageCount등은 Api 구현에 따라 달라지므로 완벽히 들어맞을 수는 없다. 용도에 맞게 사용하면 된다.</p>\n<h2>생각할 거리..</h2>\n<p>페이스북이나 인스타그램을 보면, 화면의 끝에 닿았을 때 호출되는 것이 아니라 더 이른 시점에 데이터를 로드하는 것을 볼 수 있다. 그렇다면 그건 ScrollHeight를 계산해서 발생시키는 것이라고 생각되는데..\n그 방법이 사용자 관점에서는 정말 무한 스크롤의 취지에 맞는 것 같다는 생각도 든다.</p>\n<p>오늘은 여기까지!</p>\n<h2>Reference</h2>\n<p><a href=\"https://velog.io/@yeonseo07/infinite-scroll\">https://velog.io/@yeonseo07/infinite-scroll</a>\n<a href=\"https://heropy.blog/2019/10/27/intersection-observer/\">https://heropy.blog/2019/10/27/intersection-observer/</a>\n<a href=\"https://developer.mozilla.org/ko/docs/Web/API/IntersectionObserver/IntersectionObserver\">https://developer.mozilla.org/ko/docs/Web/API/IntersectionObserver/IntersectionObserver</a></p>","fields":{"slug":"/new-beginnings/"},"frontmatter":{"date":"May 28, 2015","title":"Infinite Scroll Util","description":"This is a custom description for SEO and Open Graph purposes, rather than the default generated excerpt. Simply add a description field to the frontmatter.","category":"TypeScript"}},{"excerpt":"Wow! I love blogging so much already. Did you know that “despite its name, salted duck eggs can also be made from\nchicken eggs, though the…","html":"<p>Wow! I love blogging so much already.</p>\n<p>Did you know that “despite its name, salted duck eggs can also be made from\nchicken eggs, though the taste and texture will be somewhat different, and the\negg yolk will be less rich.”?\n(<a href=\"https://en.wikipedia.org/wiki/Salted_duck_egg\">Wikipedia Link</a>)</p>\n<p>Yeah, I didn’t either.</p>","fields":{"slug":"/my-second-post/"},"frontmatter":{"date":"May 06, 2015","title":"My Second Post!","description":null,"category":"React"}}]}},"pageContext":{"id":"d6c69e7c-b6a3-5c46-9d67-4ee147254eed","previousPostId":null,"nextPostId":"fa4751e8-a846-53b0-925a-f7d2c410c3b0"}},"staticQueryHashes":["2841359383","3868140423"]}